{{/* 
  Month overview partial template
  Rendered by /ui/month-overview HTMX endpoint
  Expects: .Year, .Month, .Total, .Rows (category totals), .Items (expense details)
*/}}
<section id="month-overview" class="month-overview">
  <h2>Panoramica Mensile</h2>
  <div class="overview-body">
    {{/* Total amount display */}}
    <div class="total">Totale mensile: <strong>{{ .Total }}</strong></div>
    
    {{/* Scale legend (if available) */}}
    {{ if .MaxName }}
    <div class="legend">Scala relativa a: <em>{{ .MaxName }}</em> ({{ .Max }})</div>
    {{ end }}
    
    {{/* Category breakdown with bars */}}
    <div class="categories">
      {{ if .Rows }}
        {{ range .Rows }}
        <div class="row">
          <div class="name">{{ .Name }}</div>
          <div class="amount">{{ .Amount }}</div>
          <div class="bar" aria-hidden="true">
            <div class="bar__fill" style="width: {{ .Width }}%"></div>
          </div>
        </div>
        {{ end }}
      {{ else }}
        <div class="row placeholder">Nessun dato</div>
      {{ end }}
    </div>
    
    {{/* Expense details section */}}
    <div class="expenses">
      <h3>Dettagli Spese</h3>
      {{ if .Items }}
        <div class="expenses__list">
          {{ range .Items }}
            <div class="expense" id="expense-{{ .ID }}">
              <div class="expense__date">{{ .Day }}/{{ $.Month }}</div>
              <div class="expense__desc">{{ .Desc }} <small style="color: #999;">[ID: {{ .ID }}]</small></div>
              <div class="expense__cat">{{ .Cat }} / {{ .Sub }}</div>
              <div class="expense__amt">{{ .Amt }}</div>
              {{ template "action_buttons" (dict "ShowDelete" true "DeleteURL" "/expenses/delete" "DeleteVals" (printf "{\"id\": \"%d\"}" .ID) "DeleteTarget" (printf "#expense-%d" .ID) "DeleteConfirm" "Sei sicuro di voler cancellare questa spesa?") }}
            </div>
          {{ end }}
        </div>
      {{ else }}
        <div class="row placeholder">Nessuna spesa registrata</div>
      {{ end }}
    </div>
  </div>
</section>
