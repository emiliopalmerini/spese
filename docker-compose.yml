services:
  spese:
    build: .
    image: spese:dev
    container_name: spese
    env_file:
      - .env
    ports:
      - "${PORT:-8081}:${PORT:-8081}"
    environment:
      - PORT=${PORT:-8081}
      - BASE_URL=${BASE_URL:-http://localhost:${PORT:-8081}}
      - DATA_BACKEND=${DATA_BACKEND:-sqlite}
      - SQLITE_DB_PATH=/data/spese.db
      # Sync Processor configuration
      - SYNC_BATCH_SIZE=${SYNC_BATCH_SIZE:-10}
      - SYNC_INTERVAL=${SYNC_INTERVAL:-30s}
      # Recurring Processor configuration
      - RECURRING_PROCESSOR_INTERVAL=${RECURRING_PROCESSOR_INTERVAL:-1h}
      # Google Sheets configuration
      - GOOGLE_SPREADSHEET_ID=${GOOGLE_SPREADSHEET_ID}
      - GOOGLE_SHEET_NAME=${GOOGLE_SHEET_NAME:-Expenses}
      - GOOGLE_CATEGORIES_SHEET_NAME=${GOOGLE_CATEGORIES_SHEET_NAME:-Dashboard}
      - GOOGLE_SUBCATEGORIES_SHEET_NAME=${GOOGLE_SUBCATEGORIES_SHEET_NAME:-Dashboard}
      - DASHBOARD_SHEET_NAME=${DASHBOARD_SHEET_NAME:-Dashboard}
      # Service Account credentials for Google Sheets access
      - GOOGLE_SERVICE_ACCOUNT_FILE=/service-account.json
    volumes:
      - ./configs/service-account.json:${GOOGLE_SERVICE_ACCOUNT_FILE:-/service-account.json}:ro
      - spese_data:/data
    restart: unless-stopped

volumes:
  spese_data:
